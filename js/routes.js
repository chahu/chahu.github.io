"use strict";async function init(t,e,o){e.append("g").attr("id","routes");const a=new Pikaday({field:document.getElementById("current_date"),position:"top right",minDate:string_to_date(o.get_min_route_date()),maxDate:string_to_date(o.get_max_route_date()),onSelect:async function(t){t instanceof Date&&(t=date_to_string(t));const e=await o.get_routes(t);avoid_collision.reset&&avoid_collision.reset(),update_routes(e),$("#current_count").text(`(${e.length})`)}});a.setDate(string_to_date("2020-01-01")),$("#previous_date").click(()=>{const t=a.getDate();t.setDate(t.getDate()-1),date_to_string(t)>=o.get_min_route_date()&&a.setDate(t)}),$("#next_date").click(()=>{const t=a.getDate();t.setDate(t.getDate()+1),date_to_string(t)<=o.get_max_route_date()&&a.setDate(t)})}function update_routes(t){const e=d3.select("#routes").selectAll("circle.route").data(t,t=>t.id);e.enter().append("circle").attr("class","route").attr("opacity",1).attr("fill",t=>get_color(t.route_color)).attr("fill-opacity",0).attr("stroke",t=>get_color(t.route_color)).attr("stroke-width","1px").attr("cx",t=>t.x).attr("cy",t=>t.y).attr("r",5).on("mouseover",t=>hover(t,avoid_collision(t))).on("mouseout",(t,e,o)=>{d3.select("#info_div").transition().delay(200).duration(100).style("opacity",0)}).on("click",t=>window.open("https://www.vertical-life.info/en/indoor/the-cliffs-at-lic/climbs/"+t.route_id,"_blank")).transition().duration(1e3).attr("r",5).attr("cx",t=>avoid_collision(t).x).attr("cy",t=>avoid_collision(t).y),e.transition().duration(1e3).attr("r",5).attr("cx",t=>avoid_collision(t).x).attr("cy",t=>avoid_collision(t).y),e.exit().transition().duration(1e3).attr("r",20).attr("opacity",0).remove()}$(document).ready(async()=>{const t=d3.select("#svg_container"),e=await load_svg(t),o=new DataManager;await init(t,e,o)});
