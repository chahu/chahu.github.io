"use strict";function init(t,e,o){e.append("g").attr("id","events"),console.log(t,e,o);const n={};let i,a;o.forEach(t=>{(!i||t.date>i)&&(i=t.date),(!a||t.date<a)&&(a=t.date),n[t.date]=!0}),new Pikaday({field:document.getElementById("current_date"),position:"top right",disableDayFn:t=>!n[date_to_string(t)],minDate:string_to_date(a),maxDate:string_to_date(i),onSelect:function(t){t instanceof Date&&(t=date_to_string(t));const e=o.filter(e=>e.date==t);avoid_collision.reset&&avoid_collision.reset(),update(e),$("#current_count").text(`(${e.length})`)},parse:(t,e)=>{const o=t.split("-");return new Date(o[0],o[1],o[2])}}).setDate(string_to_date("2020-01-03"))}function update(t){const e=d3.select("#events").selectAll("circle.event").data(t,t=>t.id);console.log(t),e.enter().append("circle").attr("class","event").attr("fill",t=>get_color(t.route_color)).attr("stroke",t=>contrast_color("white",get_color(t.route_color))).attr("stroke-width","2").attr("cx",t=>t.x).attr("cy",t=>t.y).attr("r",0).on("mouseover",t=>hover(t,avoid_collision(t))).on("mouseout",(t,e,o)=>{d3.select("#info_div").transition().delay(200).duration(100).style("opacity",0)}).on("click",t=>window.open("https://www.vertical-life.info/en/indoor/the-cliffs-at-lic/climbs/"+t.route_id,"_blank")).transition().attr("r",5).transition().attr("cx",t=>avoid_collision(t).x).attr("cy",t=>avoid_collision(t).y),e.transition().duration(500).attr("fill",t=>get_color(t.route_color)).attr("r",5),e.exit().remove()}$(document).ready(async()=>{const t=d3.select("#svg_container");load_svg(t).then(e=>{d3.csv("data/charlie.csv").then(o=>{o.forEach((t,e)=>{const o=d3.select("#"+t.wall).node().getPointAtLength(t.offset);t.x=o.x,t.y=o.y,t.offset=parseFloat(t.offset),t.id=e}),init(t,e,o)})})});
